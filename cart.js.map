{"version":3,"file":"cart.js","sources":["../src/cart.js"],"sourcesContent":["//Логіка сторінки Cart\nimport { fetchProductsById } from \"./js/products-api\";\nimport { renderProducts, renderProductInModal } from \"./js/render-function\";\nimport { productsList, notFoundDiv, modal, cartButton, navCountCart, cartCount, cartPrice, cartSummaryButton, navCount } from \"./js/constants\";\nimport { getCart, addToCart, removeFromCart, isInCart, getWishlist } from \"./js/storage\";\nimport iziToast from \"izitoast\";\nimport { changeTheme } from \"./js/helpers\";\n    \n    \n// Функція оновлення кількості у навігації\nconst updateNavCountCart = () => {\n  const wishlist = getWishlist();\n  navCount.textContent = wishlist.length;\n};\n\nconst updateNavCount = () => {\n  const cart = getCart();\n  navCountCart.textContent = cart.length;\n};\n\n// Функція оновлення кнопки Cart в модалці\nconst updateCartButton = (productId) => {\n  if (isInCart(productId)) {\n    cartButton.textContent = 'Remove from Cart';\n  } else {\n    cartButton.textContent = 'Add to Cart';\n  }\n};\n\n\n// Оновлення Total Items та Total Price\nconst updatecartSummary = async () => {\n    const cart = getCart();\n\n\n    if (cart.length === 0) {\n        cartCount.textContent = \"0\";\n        cartPrice.textContent = \"$0.00\";\n        return;\n    }\n    \n    try {\n        const productPromises = cart.map(id => fetchProductsById(id));\n        const products = await Promise.all(productPromises);\n\n        cartCount.textContent = products.length;\n\n        const total = products.reduce((sum, product) => sum + (product.price || 0), 0);\n            \n        cartPrice.textContent = `$${total.toFixed(2)}`;\n    } catch (error) {\n    console.error('Помилка при підрахунку Total:', error);\n    cartCount.textContent = '0';\n    cartPrice.textContent = '$0.00';\n  }\n}\n\n\n// Завантажити продукти з cart та відрендерити їх\nconst loadCartProducts = async () => {\n  const cart = getCart();\n\n    if (cart.length === 0) {\n        notFoundDiv.classList.add('not-found--visible');\n        productsList.innerHTML = '';\n        return;\n    }\n\n    try {\n        const productPromises = cart.map(id => fetchProductsById(id));\n        const products = await Promise.all(productPromises);\n\n        notFoundDiv.classList.remove('not-found--visible');\n        renderProducts(products);\n    } catch (error) {\n        console.error('Помилка при завантаженні cart:', error);\n        notFoundDiv.classList.add('not-found--visible');\n        productsList.innerHTML = '';\n    }\n};\n\n// При кліку на продукт відкриваємо модалку\nproductsList.addEventListener(\"click\", async (event) => {\n  const productItem = event.target.closest(\"li.products__item\");\n  if (!productItem) return;\n\n  const productId = productItem.dataset.id;\n  if (!productId) return;\n\n  try {\n    const product = await fetchProductsById(productId);\n    renderProductInModal(product);\n    modal.classList.add(\"modal--is-open\");\n\n    updateCartButton(productId);\n\n    // Логіка додавання/видалення до Wishlist\n    cartButton.onclick = () => {\n      if (isInCart(productId)) {\n        removeFromCart(productId);\n      } else {\n        addToCart(productId);\n      }\n        updateCartButton(productId);\n        updateNavCountCart();\n        loadCartProducts(); // Оновлюємо список на сторінці Wishlist після видалення\n        updatecartSummary();\n    };\n\n  } catch (error) {\n    console.error('Помилка при завантаженні продукту:', error);\n  }\n});\n\ncartSummaryButton.addEventListener('click', async () => {\n  const cart = getCart();\n\n  if (cart.length === 0) {\n    iziToast.warning({\n        title: 'Oops!',\n        message: 'Your cart is empty!',\n        position: \"topLeft\"\n    });\n    return;\n  }\n\niziToast.success({\n    title: 'Success!',\n    message: 'Products purchased successfully!',\n    position: \"topLeft\"\n});\n\n  localStorage.removeItem('cart'); // очищаємо cart\n  await loadCartProducts();\n  updateNavCountCart();\n  await updatecartSummary();\n});\n\n// Закриття модалки\nmodal.addEventListener(\"click\", (event) => {\n  if (event.target === modal || event.target.classList.contains(\"modal__close-btn\")) {\n    modal.classList.remove(\"modal--is-open\");\n  }\n});\n\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    loadCartProducts();\n    updateNavCountCart();// оновлення лічильника при завантаженні сторінки\n    updateNavCount();\n    updatecartSummary(); \n});\n\nchangeTheme();"],"names":["updateNavCountCart","wishlist","getWishlist","navCount","updateNavCount","cart","getCart","navCountCart","updateCartButton","productId","isInCart","cartButton","updatecartSummary","cartCount","cartPrice","productPromises","id","fetchProductsById","products","total","sum","product","error","loadCartProducts","notFoundDiv","productsList","renderProducts","event","productItem","renderProductInModal","modal","removeFromCart","addToCart","cartSummaryButton","iziToast","changeTheme"],"mappings":"wNAUA,MAAMA,EAAqB,IAAM,CAC/B,MAAMC,EAAWC,IACjBC,EAAS,YAAcF,EAAS,MAClC,EAEMG,EAAiB,IAAM,CAC3B,MAAMC,EAAOC,IACbC,EAAa,YAAcF,EAAK,MAClC,EAGMG,EAAoBC,GAAc,CAClCC,EAASD,CAAS,EACpBE,EAAW,YAAc,mBAEzBA,EAAW,YAAc,aAE7B,EAIMC,EAAoB,SAAY,CAClC,MAAMP,EAAOC,IAGb,GAAID,EAAK,SAAW,EAAG,CACnBQ,EAAU,YAAc,IACxBC,EAAU,YAAc,QACxB,MACH,CAED,GAAI,CACA,MAAMC,EAAkBV,EAAK,IAAIW,GAAMC,EAAkBD,CAAE,CAAC,EACtDE,EAAW,MAAM,QAAQ,IAAIH,CAAe,EAElDF,EAAU,YAAcK,EAAS,OAEjC,MAAMC,EAAQD,EAAS,OAAO,CAACE,EAAKC,IAAYD,GAAOC,EAAQ,OAAS,GAAI,CAAC,EAE7EP,EAAU,YAAc,IAAIK,EAAM,QAAQ,CAAC,CAAC,EAC/C,OAAQG,EAAO,CAChB,QAAQ,MAAM,gCAAiCA,CAAK,EACpDT,EAAU,YAAc,IACxBC,EAAU,YAAc,OACzB,CACH,EAIMS,EAAmB,SAAY,CACnC,MAAMlB,EAAOC,IAEX,GAAID,EAAK,SAAW,EAAG,CACnBmB,EAAY,UAAU,IAAI,oBAAoB,EAC9CC,EAAa,UAAY,GACzB,MACH,CAED,GAAI,CACA,MAAMV,EAAkBV,EAAK,IAAIW,GAAMC,EAAkBD,CAAE,CAAC,EACtDE,EAAW,MAAM,QAAQ,IAAIH,CAAe,EAElDS,EAAY,UAAU,OAAO,oBAAoB,EACjDE,EAAeR,CAAQ,CAC1B,OAAQI,EAAO,CACZ,QAAQ,MAAM,iCAAkCA,CAAK,EACrDE,EAAY,UAAU,IAAI,oBAAoB,EAC9CC,EAAa,UAAY,EAC5B,CACL,EAGAA,EAAa,iBAAiB,QAAS,MAAOE,GAAU,CACtD,MAAMC,EAAcD,EAAM,OAAO,QAAQ,mBAAmB,EAC5D,GAAI,CAACC,EAAa,OAElB,MAAMnB,EAAYmB,EAAY,QAAQ,GACtC,GAAKnB,EAEL,GAAI,CACF,MAAMY,EAAU,MAAMJ,EAAkBR,CAAS,EACjDoB,EAAqBR,CAAO,EAC5BS,EAAM,UAAU,IAAI,gBAAgB,EAEpCtB,EAAiBC,CAAS,EAG1BE,EAAW,QAAU,IAAM,CACrBD,EAASD,CAAS,EACpBsB,EAAetB,CAAS,EAExBuB,EAAUvB,CAAS,EAEnBD,EAAiBC,CAAS,EAC1BT,IACAuB,IACAX,GACR,CAEG,OAAQU,EAAO,CACd,QAAQ,MAAM,qCAAsCA,CAAK,CAC1D,CACH,CAAC,EAEDW,EAAkB,iBAAiB,QAAS,SAAY,CAGtD,GAFa3B,IAEJ,SAAW,EAAG,CACrB4B,EAAS,QAAQ,CACb,MAAO,QACP,QAAS,sBACT,SAAU,SAClB,CAAK,EACD,MACD,CAEHA,EAAS,QAAQ,CACb,MAAO,WACP,QAAS,mCACT,SAAU,SACd,CAAC,EAEC,aAAa,WAAW,MAAM,EAC9B,MAAMX,EAAgB,EACtBvB,IACA,MAAMY,EAAiB,CACzB,CAAC,EAGDkB,EAAM,iBAAiB,QAAUH,GAAU,EACrCA,EAAM,SAAWG,GAASH,EAAM,OAAO,UAAU,SAAS,kBAAkB,IAC9EG,EAAM,UAAU,OAAO,gBAAgB,CAE3C,CAAC,EAGD,SAAS,iBAAiB,mBAAoB,IAAM,CAChDP,IACAvB,IACAI,IACAQ,GACJ,CAAC,EAEDuB,EAAa"}