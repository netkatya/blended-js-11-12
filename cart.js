import{p as l,f as p,r as w,m,d as C,c as x,e as I,g as P,K as b,k as f,h as E,j as M,n as T,l as k,L as i,M as d,o as u,q as S}from"./assets/helpers-C_rlYvg-.js";import{i as h}from"./assets/vendor-C-ssPgaG.js";const $=()=>{const t=M();T.textContent=t.length},y=()=>{const n=f().reduce((e,a)=>e+a.quantity,0);k.textContent=n},g=t=>{x(t)?C.textContent="Remove from Cart":C.textContent="Add to Cart"},L=async()=>{const t=f();if(t.length===0){i.textContent="0",d.textContent="$0.00";return}const n=t.filter(e=>typeof e.id<"u");if(n.length===0){i.textContent="0",d.textContent="$0.00";return}try{const e=await Promise.all(n.map(o=>p(o.id))),a=n.reduce((o,s)=>o+s.quantity,0);i.textContent=a;const r=e.reduce((o,s)=>{const c=n.find(q=>q.id===s.id);return o+s.price*(c?c.quantity:1)},0);d.textContent=`$${r.toFixed(2)}`}catch(e){console.error("Помилка при оновленні підсумку кошика:",e),i.textContent="0",d.textContent="$0.00"}},v=async()=>{const t=f();if(t.length===0){u.classList.add("not-found--visible"),l.innerHTML="";return}const n=t.filter(e=>typeof e.id<"u");if(n.length===0){u.classList.add("not-found--visible"),l.innerHTML="";return}try{const a=(await Promise.all(n.map(o=>p(o.id)))).map(o=>{const s=n.find(c=>c.id===o.id);return{...o,quantity:s?s.quantity:1}});u.classList.remove("not-found--visible"),S(a),document.querySelectorAll(".product-quantity-product").forEach(o=>o.classList.remove("hidden"))}catch(e){console.error("Помилка при завантаженні продуктів кошика:",e),u.classList.add("not-found--visible"),l.innerHTML=""}};l.addEventListener("click",async t=>{const n=t.target;if(n.classList.contains("quantity-button"))return;const e=n.closest("li.products__item");if(!e)return;const a=Number(e.dataset.id);if(a)try{const r=await p(a);w(r),m.classList.add("modal--is-open"),g(a),C.onclick=async()=>{x(a)?I(a):P(a),g(a),y(),await v(),await L()}}catch(r){console.error("Помилка при завантаженні продукту:",r)}});b.addEventListener("click",async()=>{if(f().length===0){h.warning({title:"Oops!",message:"Your cart is empty!",position:"topLeft"});return}h.success({title:"Success!",message:"Products purchased successfully!",position:"topLeft"}),localStorage.removeItem("cart"),await v(),y(),await L()});m.addEventListener("click",t=>{(t.target===m||t.target.classList.contains("modal__close-btn"))&&m.classList.remove("modal--is-open")});document.addEventListener("DOMContentLoaded",()=>{v(),y(),$(),L(),E()});
//# sourceMappingURL=cart.js.map
