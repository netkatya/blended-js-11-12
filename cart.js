import{p as m,f as v,r as b,m as f,d as y,c as x,e as I,g as w,K as P,k as i,h as E,L as k,j as B,n as M,l as N,M as d,N as u,o as l,q as S}from"./assets/helpers-gTZ7zHJP.js";import{i as g}from"./assets/vendor-C-ssPgaG.js";const T=()=>{const e=B();M.textContent=e.length},p=()=>{const n=i().reduce((s,t)=>s+t.quantity,0);N.textContent=n},h=e=>{x(e)?y.textContent="Remove from Cart":y.textContent="Add to Cart"},C=async()=>{const e=i();if(e.length===0){d.textContent="0",u.textContent="$0.00";return}const n=e.filter(s=>typeof s.id<"u");if(n.length===0){d.textContent="0",u.textContent="$0.00";return}try{const s=await Promise.all(n.map(a=>v(a.id))),t=n.reduce((a,r)=>a+r.quantity,0);d.textContent=t;const o=s.reduce((a,r)=>{const c=n.find(q=>q.id===r.id);return a+r.price*(c?c.quantity:1)},0);u.textContent=`$${o.toFixed(2)}`}catch(s){console.error("Помилка при оновленні підсумку кошика:",s),d.textContent="0",u.textContent="$0.00"}},L=async()=>{const e=i();if(e.length===0){l.classList.add("not-found--visible"),m.innerHTML="";return}const n=e.filter(s=>typeof s.id<"u");if(n.length===0){l.classList.add("not-found--visible"),m.innerHTML="";return}try{const t=(await Promise.all(n.map(a=>v(a.id)))).map(a=>{const r=n.find(c=>c.id===a.id);return{...a,quantity:r?r.quantity:1}});l.classList.remove("not-found--visible"),S(t),document.querySelectorAll(".product-quantity-product").forEach(a=>a.classList.remove("hidden"))}catch(s){console.error("Помилка при завантаженні продуктів кошика:",s),l.classList.add("not-found--visible"),m.innerHTML=""}};m.addEventListener("click",async e=>{const n=e.target;if(n.classList.contains("quantity-button"))return;const s=n.closest("li.products__item");if(!s)return;const t=Number(s.dataset.id);if(t)try{const o=await v(t);b(o),f.classList.add("modal--is-open"),h(t),y.onclick=async()=>{x(t)?I(t):w(t),h(t),p(),await L(),await C()}}catch(o){console.error("Помилка при завантаженні продукту:",o)}});P.addEventListener("click",async()=>{if(i().length===0){g.warning({title:"Oops!",message:"Your cart is empty!",position:"topLeft"});return}g.success({title:"Success!",message:"Products purchased successfully!",position:"topLeft"}),localStorage.removeItem("cart"),await L(),p(),await C()});f.addEventListener("click",e=>{(e.target===f||e.target.classList.contains("modal__close-btn"))&&f.classList.remove("modal--is-open")});document.addEventListener("DOMContentLoaded",()=>{L(),p(),T(),C(),E()});document.addEventListener("click",async e=>{const n=e.target.closest(".plus-button"),s=e.target.closest(".minus-button");if(n||s){const t=e.target.closest(".product");if(!t)return;const o=t.dataset.id;if(!o)return;const a=t.querySelector(".quantity-input");if(!a)return;let r=parseInt(a.value,10)||0;n?r+=1:s&&r>0&&(r-=1),a.value=r,r>0?$(o,r):I(o),await C(),p()}});const $=(e,n)=>{const s=Number(e);let t=i();const o=t.findIndex(a=>Number(a.id)===s);o!==-1?n>0?t[o].quantity=n:t.splice(o,1):n>0&&t.push({id:s,quantity:n}),k(t)};
//# sourceMappingURL=cart.js.map
