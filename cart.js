import{p as l,f as g,r as P,m,c as y,d as x,e as q,g as E,K as k,k as c,h as B,L as M,j as N,n as S,l as T,M as i,N as d,o as u,q as $}from"./assets/helpers-C7-H_RJe.js";import{i as L}from"./assets/vendor-C-ssPgaG.js";const _=()=>{const e=N();S.textContent=e.length},f=()=>{const n=c().reduce((s,t)=>s+t.quantity,0);T.textContent=n},I=e=>{x(e)?y.textContent="Remove from Cart":y.textContent="Add to Cart"},p=async()=>{const e=c();if(e.length===0){i.textContent="0",d.textContent="$0.00";return}const n=e.filter(s=>typeof s.id<"u");if(n.length===0){i.textContent="0",d.textContent="$0.00";return}try{const s=await Promise.all(n.map(a=>g(a.id))),t=n.reduce((a,r)=>a+r.quantity,0);i.textContent=t;const o=s.reduce((a,r)=>{const b=n.filter(C=>C.id===r.id).reduce((C,w)=>C+w.quantity,0);return a+r.price*b},0);d.textContent=`$${o.toFixed(2)}`}catch(s){console.error("Помилка при оновленні підсумку кошика:",s),i.textContent="0",d.textContent="$0.00"}},v=async()=>{const e=c();if(e.length===0){u.classList.add("not-found--visible"),l.innerHTML="";return}const n=e.filter(s=>typeof s.id<"u");if(n.length===0){u.classList.add("not-found--visible"),l.innerHTML="";return}try{const t=(await Promise.all(n.map(a=>g(a.id)))).map(a=>{const r=n.find(h=>h.id===a.id);return{...a,quantity:r?r.quantity:1}});u.classList.remove("not-found--visible"),$(t),document.querySelectorAll(".product-quantity-product").forEach(a=>a.classList.remove("hidden"))}catch(s){console.error("Помилка при завантаженні продуктів кошика:",s),u.classList.add("not-found--visible"),l.innerHTML=""}};l.addEventListener("click",async e=>{const n=e.target;if(n.classList.contains("quantity-button"))return;const s=n.closest("li.products__item");if(!s)return;const t=Number(s.dataset.id);if(t)try{const o=await g(t);P(o),m.classList.add("modal--is-open"),I(t),y.onclick=async()=>{x(t)?q(t):E(t),I(t),f(),await v(),await p()}}catch(o){console.error("Помилка при завантаженні продукту:",o)}});k.addEventListener("click",async()=>{if(c().length===0){L.warning({title:"Oops!",message:"Your cart is empty!",position:"topLeft"});return}L.success({title:"Success!",message:"Products purchased successfully!",position:"topLeft"}),localStorage.removeItem("cart"),await v(),f(),await p()});m.addEventListener("click",e=>{(e.target===m||e.target.classList.contains("modal__close-btn"))&&m.classList.remove("modal--is-open")});document.addEventListener("DOMContentLoaded",()=>{v(),f(),_(),p(),B()});document.addEventListener("click",async e=>{const n=e.target.closest(".plus-button"),s=e.target.closest(".minus-button");if(n||s){const t=e.target.closest(".product");if(!t)return;const o=t.dataset.id;if(!o)return;const a=t.querySelector(".quantity-input");if(!a)return;let r=parseInt(a.value,10)||0;n?r+=1:s&&r>0&&(r-=1),a.value=r,r>0?D(o,r):q(o),await p(),f()}});const D=(e,n)=>{const s=Number(e);let t=c();const o=t.findIndex(a=>Number(a.id)===s);o!==-1?n>0?t[o].quantity=n:t.splice(o,1):n>0&&t.push({id:s,quantity:n}),M(t)};
//# sourceMappingURL=cart.js.map
